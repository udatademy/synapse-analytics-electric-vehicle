{
	"name": "1_explore_vehicle",
	"properties": {
		"folder": {
			"name": "electric_vechicle/explorer"
		},
		"content": {
			"query": "-- This is auto-generated code\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://asynapsealds.dfs.core.windows.net/electric-vehicle-data/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0'\n    ) AS [result];\n\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) AS [result];\n\n\n-- Examine the data types for the columns\nEXEC sp_describe_first_result_set N'SELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK ''abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv'',\n        FORMAT = ''CSV'',\n        PARSER_VERSION = ''2.0'',\n        HEADER_ROW = TRUE\n    ) AS [result];'\n\n\nSELECT\n    MAX(LEN(vehicleId)) AS vehicle_id,\n    MAX(LEN(vin)) AS vin,\n    MAX(LEN(modelYear)) AS model_year,\n    MAX(LEN(make)) AS make,\n    MAX(LEN(model)) AS model,\n    MAX(LEN(electricRange)) AS electric_range,\n    MAX(LEN(baseMSRP)) AS base_MSRP,\n    MAX(LEN(vehicheTypeId)) AS vehiche_type_id,\n    MAX(LEN(cafvEligibilityId)) AS cafv_eligibility_id,\n    MAX(LEN(vehicleLocation)) AS vehicle_location\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS [result];\n\n\n-- Use WITH clause to provide explicit data type\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) WITH(\n        vehicleId           INT,\n        vin                 VARCHAR(10),\n        modelYear           SMALLINT,\n        make                VARCHAR(25),\n        model               VARCHAR(25),\n        electricRange       SMALLINT,\n        baseMSRP            INT,\n        vehicheTypeId       SMALLINT,\n        cafvEligibilityId   SMALLINT,\n        vehicleLocation     VARCHAR(30)\n    ) AS [result];\n\n\nEXEC sp_describe_first_result_set N'SELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK ''abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv'',\n        FORMAT = ''CSV'',\n        PARSER_VERSION = ''2.0'',\n        HEADER_ROW = TRUE\n    ) WITH(\n        vehicleId           INT,\n        vin                 VARCHAR(10),\n        modelYear           SMALLINT,\n        make                VARCHAR(25),\n        model               VARCHAR(25),\n        electricRange       SMALLINT,\n        baseMSRP            INT,\n        vehicheTypeId       SMALLINT,\n        cafvEligibilityId   SMALLINT,\n        vehicleLocation     VARCHAR(30)\n    ) AS [result];'\n\n\nSELECT name, collation_name\nFROM sys.databases;\n\n-- Specify UTF-8 Collation for VARCHAR columns\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) WITH(\n        vehicleId           INT,\n        vin                 VARCHAR(10) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        modelYear           SMALLINT,\n        make                VARCHAR(25) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        model               VARCHAR(25) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        electricRange       SMALLINT,\n        baseMSRP            INT,\n        vehicheTypeId       SMALLINT,\n        cafvEligibilityId   SMALLINT,\n        vehicleLocation     VARCHAR(30) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n    ) AS [result];\n\n\nCREATE DATABASE electric_vehicle_explorer;\n\nUSE electric_vehicle_explorer;\n\nALTER DATABASE electric_vehicle_explorer COLLATE Latin1_General_100_CI_AI_SC_UTF8;\n\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) WITH(\n        vehicleId           INT,\n        vin                 VARCHAR(10),\n        modelYear           SMALLINT,\n        make                VARCHAR(25),\n        model               VARCHAR(25),\n        electricRange       SMALLINT,\n        baseMSRP            INT,\n        vehicheTypeId       SMALLINT,\n        cafvEligibilityId   SMALLINT,\n        vehicleLocation     VARCHAR(30)\n    ) AS [result];\n\n\n-- Select only subset of columns\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) WITH(\n        vin                 VARCHAR(10),\n        modelYear           SMALLINT,\n        make                VARCHAR(25),\n        model               VARCHAR(25),\n        electricRange       SMALLINT,\n        baseMSRP            INT\n    ) AS [result];\n\n--  Read data frrom a file without header\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle_without_header.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0'\n    ) WITH(\n        vin                 VARCHAR(10) 2,\n        make                VARCHAR(25) 4,\n        model               VARCHAR(25) 5\n    ) AS [result];\n\n-- Fix Column Names\n-- 1st Form\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) WITH(\n        vehicle_id           INT 1,\n        vin                  VARCHAR(10) 2,\n        model_year           SMALLINT 3,\n        make                 VARCHAR(25) 4,\n        model                VARCHAR(25) 5,\n        electric_range       SMALLINT 6,\n        base_MSRP            INT 7,\n        vehiche_type_id      SMALLINT 8,\n        cafv_eligibility_id  SMALLINT 9,\n        vehicle_location     VARCHAR(30) 10\n    ) AS [result];\n\n-- 2nd Form\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/vehicle.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIRSTROW = 2\n    ) WITH(\n        vehicle_id           INT,\n        vin                  VARCHAR(10),\n        model_year           SMALLINT,\n        make                 VARCHAR(25),\n        model                VARCHAR(25),\n        electric_range       SMALLINT,\n        base_MSRP            INT,\n        vehiche_type_id      SMALLINT,\n        cafv_eligibility_id  SMALLINT,\n        vehicle_location     VARCHAR(30)\n    ) AS [result];\n\n-- Create External Data Source\nCREATE EXTERNAL DATA SOURCE electric_vehicle_data\nWITH(\n    LOCATION = 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/'\n);\n\nCREATE EXTERNAL DATA SOURCE electric_vehicle_data_bronze\nWITH(\n    LOCATION = 'abfss://electric-vehicle-data@asynapsealds.dfs.core.windows.net/bronze/'\n);\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'vehicle.csv',\n        DATA_SOURCE = 'electric_vehicle_data_bronze',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIRSTROW = 2\n    ) WITH(\n        vehicle_id           INT,\n        vin                  VARCHAR(10),\n        model_year           SMALLINT,\n        make                 VARCHAR(25),\n        model                VARCHAR(25),\n        electric_range       SMALLINT,\n        base_MSRP            INT,\n        vehiche_type_id      SMALLINT,\n        cafv_eligibility_id  SMALLINT,\n        vehicle_location     VARCHAR(30)\n    ) AS [result];\n\n    DROP EXTERNAL DATA SOURCE electric_vehicle_data;\n\n    SELECT name, location FROM sys.external_data_sources;\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "electric_vehicle_explorer",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}